function slideDate(e,t,a,o){"use strict";return{date:e,dayName:t,primaryColor:a,accentColor:o,dateString:moment(e,"YYYY-MM-DD").format("dddd, MMMM Do")}}function loadBackground(e,t){"use strict";var a=new Image;a.crossOrigin="anonymous",a.onload=function(){background=a,t()},a.src=e}function makeSlide(e,t){"use strict";var a=$("#edit-canvas")[0].getContext("2d"),o=1920,l=1080,i=.72*o;a.canvas.width=o,a.canvas.height=l,a.drawImage(background,0,0,o,l),tinycolor(e.accentColor).isLight()?a.fillStyle="rgba(255, 255, 255, 0.8)":a.fillStyle="rgba(0, 0, 0, 0.4)",a.fillRect(0,0,o,l),a.fillStyle=e.primaryColor,a.fillRect(0,0,i,l),a.fillStyle=e.accentColor,a.font="bold 295px "+font,a.fillText(e.dayName,30,270),a.font="bold 90px "+font,a.fillText(e.dateString,50,415);var n=l-40;return t.forEach(function(t){a.fillStyle=e.accentColor,a.font="bold 40px "+font,a.textAlign="end",a.fillText(t.dayName,i-20,n),a.fillStyle=e.primaryColor,a.font="normal 40px "+font,a.textAlign="start",a.fillText(t.dateString,i+20,n),n-=55}),{name:e.date,image:a.canvas.toDataURL().slice(22)}}function makeCoverSlide(){"use strict";var e=$("#edit-canvas")[0].getContext("2d"),t=1920,a=1080;return e.canvas.width=t,e.canvas.height=a,e.drawImage(background,0,0,t,a),e.fillStyle="rgba(255, 255, 255, 0.6)",e.fillRect(0,0,t,a),e.fillStyle="yellow",e.fillRect(0,a,t,-100),e.fillStyle="#215192",e.font="bold 80px "+font,e.fillText("Welcome to",50,375),e.font="bold 140px "+font,e.fillText("Averill Park High School",50,550),e.fillStyle="#5580E7",e.font="normal 90px "+font,e.fillText("Home of the Warriors",50,675),{name:"cover",image:e.canvas.toDataURL().slice(22)}}function makeZip(e){"use strict";var t=new JSZip;e.forEach(function(e){t.file(e.name+".png",e.image,{base64:!0})}),t.generateAsync({type:"blob"}).then(function(e){saveAs(e,"slides.zip")})}function toast(e,t){"use strict";var a=$(".toast");a.text(e),$(".toast").removeClass("show"),$(".toast").addClass("show"),setTimeout(function(){$(".toast").removeClass("show")},t)}function makeSlideBatch(e,t,a){"use strict";var o=$("#make-progress .progress-bar");setTimeout(function(){e.reverse().forEach(function(t){slideImages.push(makeSlide(t,e))}),o.text(5*t+"/"+a),o.width(5*t/a*100+"%")},2e3*t)}var font="Arial",background,slideImages=[];$(document).ready(function(){"use strict";$(":file").change(function(){var e=$(this),t=(e.get(0).files?e.get(0).files.length:1,e.val().replace(/\\/g,"/").replace(/.*\//,""));$("[data-file-display="+this.id+"]").val(t)}),loadBackground("https://lh3.googleusercontent.com/-Tzhft65Sdk8/WwcOua6mXNI/AAAAAAABvDU/gJYQdTu1VOoH0D1SL251NEcwq4URUjUswCHMYCw/s0/aphs-front.jpg",function(){makeSlide(slideDate(moment().format("YYYY-MM-DD"),"B Day","yellow","black"),[slideDate(moment().add(5,"days").format("YYYY-MM-DD"),"A Day"),slideDate(moment().add(4,"days").format("YYYY-MM-DD"),"B Day"),slideDate(moment().add(3,"days").format("YYYY-MM-DD"),"A Day"),slideDate(moment().add(2,"days").format("YYYY-MM-DD"),"B Day"),slideDate(moment().add(1,"days").format("YYYY-MM-DD"),"A Day")])}),$("#csv").change(function(){$("#csv").parse({config:{skipEmptyLines:!0,fastMode:!0,complete:function(e,t){toast("Started making slides, please wait...",1e4);var a=[];e.data.forEach(function(e){var t=e[0],o=e[1],l=e[2],i=e[3];"A"==o?l="cornflowerblue":"B"==o&&(l="yellow"),"A"==o?i="white":"B"==o&&(i="black"),"A"==o?o="A Day":"B"==o&&(o="B Day"),a.push(slideDate(t,o,l,i))});var o=a.length,l=5,i=1;slideImages=[makeCoverSlide()];for(var n=0;n<o;n+=l){var s=a.slice(n,n+l);makeSlideBatch(s,i,o),i++,console.log(i)}setTimeout(function(){toast("Finished making slides, downloading as .zip file..",1e4),makeZip(slideImages)},2e3*(i+1))},error:function(e,t,a,o){toast("Error reading .csv file!",1e4)}}})})});