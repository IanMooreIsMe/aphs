function SlideDate(e,a,t,i){"use strict";return{date:e,dayName:a,primaryColor:t,accentColor:i,dateString:moment(e,"YYYY-MM-DD").format("dddd, MMMM Do")}}function loadBackground(e,a){"use strict";var t=new Image;t.crossOrigin="anonymous",t.onload=function(){background=t,a()},t.src=e}function makeSlide(e,a){"use strict";var t=$("#edit-canvas")[0].getContext("2d"),i=1920,o=1080,n=.72*i;t.canvas.width=i,t.canvas.height=o,t.drawImage(background,0,0,i,o),t.fillStyle="rgba(0, 0, 0, 0.4)",t.fillRect(0,0,i,o),t.fillStyle=e.primaryColor,t.fillRect(0,0,n,o),t.fillStyle=e.accentColor,t.font="bold 295px Arial",t.fillText(e.dayName,20,250),t.font="bold 90px Arial",t.fillText(e.dateString,30,390);var l=o-40;return a.reverse().forEach(function(a){t.fillStyle=e.accentColor,t.font="bold 40px Arial",t.textAlign="end",t.fillText(a.dayName,n-20,l),t.fillStyle=e.primaryColor,t.font="normal 40px Arial",t.textAlign="start",t.fillText(a.dateString,n+20,l),l-=55}),{name:e.date,image:t.canvas.toDataURL().slice(22)}}function makeZip(e){"use strict";var a=new JSZip;e.forEach(function(e){a.file(e.name+".png",e.image,{base64:!0})}),a.generateAsync({type:"blob"}).then(function(e){saveAs(e,"slides.zip")})}function toast(e,a){"use strict";var t=$(".toast");t.text(e),$(".toast").removeClass("show"),$(".toast").addClass("show"),setTimeout(function(){$(".toast").removeClass("show")},a)}function makeSlideBatch(e,a,t){"use strict";var i=$("#make-progress .progress-bar");setTimeout(function(){e.forEach(function(a){slideImages.push(makeSlide(a,e))}),i.text(5*a+"/"+t),i.width(5*a/t*100+"%")},500*a)}var background,slideImages=[];$(document).ready(function(){$(":file").change(function(){var e=$(this),a=(e.get(0).files?e.get(0).files.length:1,e.val().replace(/\\/g,"/").replace(/.*\//,""));$("[data-file-display="+this.id+"]").val(a)}),loadBackground("https://lh3.googleusercontent.com/-mxxjgapBiMs/WwNSrX2HRbI/AAAAAAABu84/ryiIsUjIQhUPDKUfVgyaQFAHR3AGDpooACHMYCw/s0/aphs.jpg",function(){"use strict";makeSlide(SlideDate(moment().format("YYYY-MM-DD"),"A Day","cornflowerblue","white"),[SlideDate(moment().add(1,"days").format("YYYY-MM-DD"),"B Day"),SlideDate(moment().add(2,"days").format("YYYY-MM-DD"),"A Day"),SlideDate(moment().add(3,"days").format("YYYY-MM-DD"),"B Day"),SlideDate(moment().add(4,"days").format("YYYY-MM-DD"),"A Day"),SlideDate(moment().add(5,"days").format("YYYY-MM-DD"),"B Day")])}),$("#csv").change(function(){$("#csv").parse({config:{skipEmptyLines:!0,fastMode:!0,complete:function(e,a){toast("Started making slides, please wait...",1e4);var t=[];e.data.forEach(function(e){var a=e[0],i=e[1],o=e[2],n=e[3];"A"==i?o="cornflowerblue":"B"==i&&(o="yellow"),"A"==i?n="white":"B"==i&&(n="black"),"A"==i?i="A Day":"B"==i&&(i="B Day"),t.push(SlideDate(a,i,o,n))});var i=t.length,o=5,n=1;slideImages=[];for(var l=0;l<i;l+=o)week=t.slice(l,l+o),makeSlideBatch(week,n,i),n++;setTimeout(function(){makeZip(slideImages),toast("Finished making slides, downloading as .zip file..",1e4)},500*(n+1))},error:function(e,a,t,i){toast("Error reading .csv file!",1e4)}}})})});